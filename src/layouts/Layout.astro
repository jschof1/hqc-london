---
import '../styles/global.css';
import Footer from '../components/Footer.astro';

import { Schema } from 'astro-seo-schema';

export interface Props {
  title: string;
  description?: string;
}

const { title, description = "High Quality Cleaning — Luxury home cleaning for discerning London clients." } = Astro.props;

const baseUrl = 'https://highqualitycleaning.co.uk';
const canonicalUrl = Astro.url ? Astro.url.href : baseUrl;
const defaultImage = `${baseUrl}/images/mayfair.jpg`;
const serviceAreaNames = [
  'Belgravia',
  'Chelsea',
  'Kensington',
  'Mayfair',
  'Knightsbridge',
  'St John\'s Wood',
  'Hampstead',
  'Primrose Hill',
  'Highgate',
  'Weybridge',
  'Hersham',
  'Walton-on-Thames'
];

const sameAs = [
  'https://www.facebook.com/highqualityclean',
  'https://www.instagram.com/highqualityclean',
  'https://www.yell.com/biz/high-quality-clean-ltd-london-901756897/',
  'https://www.tiktok.com/@highqualityclean',
  'https://www.linkedin.com/company/86747092/',
  'https://www.instagram.com/highqualitycleanltd/',
  'https://www.bark.com/en/gb/company/high-quality-clean-ltd/LnAX9/'

];

const serviceNodes = [
  {
    '@type': 'Service',
    '@id': `${baseUrl}/#service-essentials-clean`,
    name: 'Essentials Clean™',
    serviceType: 'Luxury maintenance cleaning programme',
    description:
      'Weekly upkeep service for maintaining pristine residences between deep cleans, tailored to Central London homes.',
    provider: { '@id': `${baseUrl}/#organization` },
    areaServed: serviceAreaNames,
    audience: {
      '@type': 'Audience',
      audienceType: 'Discerning homeowners and busy professionals'
    }
  },
  {
    '@type': 'Service',
    '@id': `${baseUrl}/#service-signature-clean`,
    name: 'Signature Clean™',
    serviceType: 'Comprehensive deep cleaning programme',
    description:
      'Meticulous deep cleaning with wellness-grade products, designed for luxury interiors that demand elevated detail.',
    provider: { '@id': `${baseUrl}/#organization` },
    areaServed: serviceAreaNames,
    audience: {
      '@type': 'Audience',
      audienceType: 'Luxury property managers and high-net-worth households'
    }
  },
  {
    '@type': 'Service',
    '@id': `${baseUrl}/#service-wellclean`,
    name: 'WellClean™',
    serviceType: 'Wellness-led premium cleaning programme',
    description:
      'Concierge-level, wellness-focused cleaning protocol delivering spa-like calm across exclusive London and Surrey homes.',
    provider: { '@id': `${baseUrl}/#organization` },
    areaServed: serviceAreaNames,
    audience: {
      '@type': 'Audience',
      audienceType: 'Wellness-focused households and executive residences'
    }
  }
];

const offerNodes = serviceNodes.map((service) => ({
  '@type': 'Offer',
  '@id': `${service['@id']}-offer`,
  itemOffered: { '@id': service['@id'] },
  url: `${baseUrl}/#quote`,
  availability: 'https://schema.org/InStock',
  description: `Arrange ${service.name} with a bespoke proposal from High Quality Cleaning.`
}));

const offerCatalogNode = {
  '@type': 'OfferCatalog',
  '@id': `${baseUrl}/#offer-catalog`,
  name: 'High Quality Cleaning programmes',
  itemListElement: offerNodes.map((offer, index) => ({
    '@type': 'ListItem',
    position: index + 1,
    item: { '@id': offer['@id'] }
  }))
};

const organizationNode = {
  '@type': ['LocalBusiness', 'CleaningService'],
  '@id': `${baseUrl}/#organization`,
  name: 'High Quality Cleaning',
  alternateName: 'High Quality Clean',
  url: baseUrl,
  description,
  image: defaultImage,
  logo: `${baseUrl}/favicon.ico`,
  email: 'sales@highqualityclean.co.uk',
  telephone: '+44 20 3342 5260',
  priceRange: '£££',
  address: {
    '@type': 'PostalAddress',
    addressLocality: 'London',
    addressRegion: 'Greater London',
    postalCode: 'SW1',
    addressCountry: 'GB'
  },
  areaServed: serviceAreaNames,
  sameAs,
  contactPoint: [
    {
      '@type': 'ContactPoint',
      contactType: 'Customer Service',
      telephone: '+44 20 3342 5260',
      email: 'sales@highqualityclean.co.uk',
      areaServed: serviceAreaNames,
      availableLanguage: ['English']
    }
  ],
  aggregateRating: {
    '@type': 'AggregateRating',
    ratingValue: '5',
    bestRating: '5',
    ratingCount: 97
  },
  award: ['ISO 9001 Certified', 'DBS Checked Team', '97+ Five-star Reviews'],
  founder: {
    '@type': 'Person',
    name: 'Pedro',
    jobTitle: 'Founder',
    description:
      'Luxury hospitality professional and wellness cleaning specialist leading High Quality Cleaning.',
    knowsAbout: [
      'Luxury home cleaning',
      'Wellness-grade protocols',
      'Concierge service',
      'Quality management'
    ]
  },
  hasOfferCatalog: { '@id': offerCatalogNode['@id'] },
  makesOffer: offerNodes.map((offer) => ({ '@id': offer['@id'] }))
};

const websiteNode = {
  '@type': 'WebSite',
  '@id': `${baseUrl}/#website`,
  url: baseUrl,
  name: 'High Quality Cleaning',
  description,
  inLanguage: 'en-GB',
  publisher: { '@id': organizationNode['@id'] },
  potentialAction: {
    '@type': 'SearchAction',
    target: `${baseUrl}/?s={search_term_string}`,
    'query-input': 'required name=search_term_string'
  }
};

const webpageNode = {
  '@type': 'WebPage',
  '@id': `${canonicalUrl}#webpage`,
  url: canonicalUrl,
  name: title,
  description,
  isPartOf: { '@id': websiteNode['@id'] },
  inLanguage: 'en-GB',
  primaryImageOfPage: defaultImage,
  about: { '@id': organizationNode['@id'] }
};

const schemaItem = {
  '@context': 'https://schema.org',
  '@graph': [
    websiteNode,
    offerCatalogNode,
    organizationNode,
    webpageNode,
    ...serviceNodes,
    ...offerNodes
  ]
};
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <meta name="description" content={description} />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta name="bingbot" content="index, follow" />
    <meta name="yandexbot" content="index, follow" />
    <meta name="google" content="notranslate" />
    <meta name="google" content="notranslate" />
    <link rel="icon" href="/favicon.ico" />
    <title>{title}</title>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="95c24898-5333-41ef-8fbf-a17bcac067af"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <Schema item={schemaItem} />
    <!-- Import Global Styles (includes Tailwind) -->
    <style>
      .ar-16-9 {
        position: relative;
        width: 100%;
        padding-top: 56.25%;
      }
      .ar-16-9 > * {
        position: absolute;
        inset: 0;
      }
      .parallax {
        background-attachment: fixed;
        background-position: center;
        background-size: cover;
      }
      .ba-container {
        position: relative;
        overflow: hidden;
      }
      .ba-img,
      .ba-svg {
        position: absolute;
        inset: 0;
        height: 100%;
        width: 100%;
        object-fit: cover;
      }
      .ba-after-wrap {
        position: absolute;
        inset: 0;
        overflow: hidden;
      }
      .ba-handle {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #c9a961;
        cursor: ew-resize;
      }
      .ba-dot {
        position: absolute;
        top: 50%;
        transform: translate(-50%, -50%);
        width: 28px;
        height: 28px;
        border-radius: 9999px;
        background: #c9a961;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
      }
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .ar-16-6 {
        position: relative;
        width: 100%;
        padding-top: 37.5%;
      }
      .ar-16-6 > * {
        position: absolute;
        inset: 0;
      }
      .accordion-content {
        display: none;
      }
      .accordion.open .accordion-content {
        display: block;
      }
      .sticky-col {
        position: sticky;
        left: 0;
        background: #ffffff;
        z-index: 10;
      }

      /* View Transitions Custom Animations - More Subtle */
      ::view-transition-old(root),
      ::view-transition-new(root) {
        animation-duration: 400ms;
        animation-timing-function: cubic-bezier(0.25, 0.1, 0.25, 1);
      }

      ::view-transition-old(root) {
        animation-name: subtle-fade-out;
      }

      ::view-transition-new(root) {
        animation-name: subtle-fade-in;
      }

      @keyframes subtle-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes subtle-fade-in {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      /* Smooth page transition for content areas */
      .page-transition {
        view-transition-name: page-content;
      }

      ::view-transition-old(page-content),
      ::view-transition-new(page-content) {
        animation-duration: 500ms;
        animation-timing-function: cubic-bezier(0.2, 0, 0.2, 1);
      }

      ::view-transition-old(page-content) {
        animation-name: content-fade-out;
      }

      ::view-transition-new(page-content) {
        animation-name: content-fade-in;
      }

      @keyframes content-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes content-fade-in {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      /* Hero section specific transition - Images fade subtly */
      .hero-transition {
        view-transition-name: hero-section;
      }

      ::view-transition-old(hero-section),
      ::view-transition-new(hero-section) {
        animation-duration: 600ms;
        animation-timing-function: cubic-bezier(0.2, 0, 0.2, 1);
      }

      ::view-transition-old(hero-section) {
        animation-name: hero-image-fade-out;
      }

      ::view-transition-new(hero-section) {
        animation-name: hero-image-fade-in;
      }

      @keyframes hero-image-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes hero-image-fade-in {
        0% {
          opacity: 0;
        }
        70% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      /* Navigation transition */
      .nav-transition {
        view-transition-name: navigation;
      }

      ::view-transition-old(navigation),
      ::view-transition-new(navigation) {
        animation-duration: 300ms;
        animation-timing-function: ease-out;
      }

      /* Card transitions for gallery and service pages */
      .card-transition {
        view-transition-name: var(--card-name);
      }

      /* Image-specific transitions */
      .image-transition {
        view-transition-name: page-image;
      }

      ::view-transition-old(page-image),
      ::view-transition-new(page-image) {
        animation-duration: 700ms;
        animation-timing-function: cubic-bezier(0.2, 0, 0.2, 1);
      }

      ::view-transition-old(page-image) {
        animation-name: image-subtle-fade-out;
      }

      ::view-transition-new(page-image) {
        animation-name: image-subtle-fade-in;
      }

      @keyframes image-subtle-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes image-subtle-fade-in {
        0% {
          opacity: 0;
        }
        60% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      /* Text-specific transitions - delayed entry */
      .text-transition {
        view-transition-name: page-text;
      }

      ::view-transition-old(page-text),
      ::view-transition-new(page-text) {
        animation-duration: 800ms;
        animation-timing-function: cubic-bezier(0.2, 0, 0.2, 1);
      }

      ::view-transition-old(page-text) {
        animation-name: text-fade-out;
      }

      ::view-transition-new(page-text) {
        animation-name: text-delayed-fade-in;
      }

      @keyframes text-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }

      @keyframes text-delayed-fade-in {
        0% {
          opacity: 0;
        }
        75% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }

      /* Reduce motion for users who prefer it */
      @media (prefers-reduced-motion: reduce) {
        ::view-transition-old(root),
        ::view-transition-new(root),
        ::view-transition-old(page-content),
        ::view-transition-new(page-content),
        ::view-transition-old(hero-section),
        ::view-transition-new(hero-section),
        ::view-transition-old(navigation),
        ::view-transition-new(navigation),
        ::view-transition-old(page-image),
        ::view-transition-new(page-image),
        ::view-transition-old(page-text),
        ::view-transition-new(page-text) {
          animation-duration: 150ms;
          animation-timing-function: ease;
        }

        @keyframes fade-out {
          0%, 100% {
            transform: none;
            filter: none;
          }
        }
        
        @keyframes fade-in {
          0%, 100% {
            transform: none;
            filter: none;
          }
        }
        
        @keyframes slide-out-up {
          0%, 100% {
            transform: none;
            filter: none;
          }
        }
        
        @keyframes slide-in-up {
          0%, 100% {
            transform: none;
            filter: none;
          }
        }
        
        @keyframes hero-fade-out {
          0%, 100% {
            transform: none;
            filter: none;
          }
        }
        
        @keyframes hero-fade-in {
          0%, 100% {
            transform: none;
            filter: none;
          }
        }
      }
    </style>
  </head>
  <body class="bg-mist text-ink font-display antialiased">
    <slot />
    <Footer />
    
    <script src="../scripts/main.js"></script>
    
    <!-- Debug View Transitions (remove in production) -->
    <script>
      if (typeof window !== 'undefined' && window.location.hostname === 'localhost') {
        console.log('🎬 View Transitions Debug Mode Active');
        console.log('ViewTransition API available:', !!document.startViewTransition);
        
        // Log all transition events
        ['astro:before-preparation', 'astro:after-preparation', 'astro:before-swap', 'astro:after-swap', 'astro:page-load'].forEach(event => {
          document.addEventListener(event, () => {
            console.log(`📍 ${event} fired`);
          });
        });
      }
    </script>
  </body>
</html>
